---
title: "TP2 stats"
author: "Romain PEREIRA"
date: "5 Mars 2018"
output:
  html_document:
    df_print: paged
  pdf_document:
    fig_caption: yes
---

# 1. Echantillon, Théorème Central Limite, Estimation Monte Carlo
### 1.1 Simulation de 1000 échantillon i.i.d gaussien.
```{r, include=TRUE, echo=TRUE}
N <- 1000
n <- c(5, 30, 100)

empirical_mean <- function(vec) {
  s = 0
  for (x in vec) {
    s = s + x
  }
  return (s / (length(vec) - 1))
}

empirical_var <- function(vec) {
  m = empirical_mean(vec)
  s = 0
  for (x in vec) {
    s = s + (x - m) * (x - m)
  }
  return (s / (length(vec) - 1))
}

# fonction 'mean_hist'
#
# 'law' : fonction qui genere un vecteur de taille 'm', e.g: law(42)
# 'title': titre de l'histogramme
#
# La fonction trace 3 histogrammes de la loi de la moyenne empirique
# sur 'N' echantillons de taille dans 'ns'
mean_hist <- function(law, title) {
  for (ni in n) {
    hist(1 / (ni - 1) * apply(matrix(law(ni * N), nrow=ni, ncol=N), 2, sum),
        xlab=paste("Moyenne empirique, enchantillon de taille n=", ni),
        main=title)
  }
}

mean_hist(function(m) { return (rnorm(m, mean=1, sd=2)) }, "Distribution Gausienne N(1, 2)")
```

D'après le théorème central limite, la loi théorique de la moyenne empirique est une loi normal $N(\mu=1, \sigma=2/\sqrt{n})$

En notant $(a_n, b_n) = (\mu, \frac{\sigma}{\sqrt{n}}) = (1, \frac{2}{\sqrt{n}})$,
$U_n = \frac{\bar{X_n} - a_n}{b_n}$ suit une loi normal centrée réduite $N(0, 1)$.

```{r, include=TRUE, echo=TRUE}
# fonction 'mean_norm_hist'
#
# 'law' : fonction qui genere un vecteur de taille 'm', e.g: law(42)
# 'title': titre de l'histogramme
#
# La fonction trace 3 histogrammes de la loi de la moyenne empirique renormalisé
# sur 'N' echantillons de taille dans 'ns'
mean_norm_hist <- function(law, title) {
  for (ni in n) {
    vsample <- law(ni * N)
    msample <- matrix(vsample, nrow=ni, ncol=N)
    an <- empirical_mean(vsample)
    bn <- empirical_var(vsample) / sqrt(ni)
    hist(1 / bn * apply(msample, 2, function(x) {return (x - an)}),
        xlab=paste("Moyenne empirique renormalisé, enchantillon de taille n=", ni),
        main=title)
  }
}

mean_norm_hist(function(m) { return (rnorm(m, mean=1, sd=2)) }, "Distribution Gausienne N(1, 2)")
```

Les histogrammes obtenus montrent en effet une loi normale centrée réduite.

Plus $n$ est grand, plus la loi moyenne empirique renormalisé semble suivre une loi N(0, 1).
(cf [Théorème Central Limite](https://fr.wikipedia.org/wiki/Théorème_central_limite))

### 1.2 Loi de Pareto

### 1.3 Loi de Poisson
Soit $X$ une variable aléatoire suivant une loi de Poisson $P(\lambda)$.
Alors, $\mathbb{E}[X]=\lambda$ et $\mathbb{V}[X]=\lambda$

```{r, include=TRUE, echo=TRUE}
mean_hist(function(m) { return (rpois(m, lambda=1)) }, "Distribution suivant une loi de Poisson P(1)")
mean_norm_hist(function(m) { return (rpois(m, lambda=1)) }, "Distribution suivant une loi de Poisson P(1)")
```
